# 4.1 네트워크 계층 개요
## 4.1.1 포워딩과 라우팅: 데이터 평면과 제어 평면
---

### **데이터 평면(Data Plane)**
- **역할**: 실제 데이터를 처리하고 전달하는 작업을 담당한다.
  - 입력 링크에서 들어온 데이터그램을 출력 링크로 전달.
  - **포워딩** 작업을 수행하여 데이터 패킷을 올바른 방향으로 보냄.
- **작동 방식**: 
  - 패킷 헤더 정보를 기반으로 라우터의 포워딩 테이블을 참고하여 포워딩 결정.
  - 주로 **고속 하드웨어**나 ASIC(Application-Specific Integrated Circuit)에서 실행되어 성능이 중요.
- **특징**:
  - **로컬** 작업에 국한됨: 각 라우터에서 독립적으로 작동.
  - 데이터 전송의 실질적인 처리와 관련됨.
- **예시**:
  - IP 주소를 기반으로 목적지 포트로 패킷을 전달.
  - QoS(Quality of Service) 기능 수행.

---

### **제어 평면(Control Plane)**
- **역할**: 네트워크의 동작과 관리를 결정하는 논리를 담당한다.
  - 라우터 간 통신 및 네트워크 경로 설정(라우팅).
  - **라우팅 프로토콜**(e.g., OSPF, BGP)을 통해 전체 네트워크 경로를 최적화.
- **작동 방식**:
  - 라우터가 네트워크 상태를 교환하여 **라우팅 테이블**과 **포워딩 테이블**을 생성 및 갱신.
  - 소프트웨어에서 주로 실행되며, 네트워크 트래픽이 많아도 빈번하게 실행되지 않음.
- **특징**:
  - 네트워크의 전반적인 **글로벌 논리**를 관리.
  - 실시간 성능보다 **효율적인 경로 결정**에 초점.
- **예시**:
  - 라우터가 이웃 라우터와 라우팅 정보를 교환하여 최적 경로를 설정.
  - 트래픽 공학(TE) 및 정책 기반 라우팅.

---

### **주요 차이점 요약**
| **구분**          | **데이터 평면(Data Plane)**                          | **제어 평면(Control Plane)**                         |
|--------------------|---------------------------------------------------|----------------------------------------------------|
| **역할**           | 데이터그램 전달(포워딩 수행)                      | 네트워크 경로 설정 및 관리                         |
| **범위**           | 로컬 라우터 내 동작                              | 네트워크 전체 경로 논리 관리                       |
| **작동 위치**      | 하드웨어 기반(고속 처리)                         | 소프트웨어 기반(논리적 처리)                       |
| **주요 구성 요소** | 포워딩 테이블                                    | 라우팅 테이블, 라우팅 프로토콜                    |
| **실행 빈도**      | 패킷마다 작동                                    | 필요 시 라우팅 테이블 변경 시 작동                 |

---

### **비유를 통한 이해**
- **데이터 평면**: 고속도로 위의 차량(데이터그램)이 실제로 이동하는 작업.
- **제어 평면**: 고속도로를 설계하고 신호 체계를 관리하는 교통 통제 시스템.


---

### **포워딩(Forwarding)**

- **정의**:  
  패킷이 **라우터의 입력 링크**에 도착했을 때, 라우터는 그 패킷을 **출력 링크**로 전달하는 작업이다.
  - 주로 라우터의 **포워딩 테이블**을 참고하여 수행.
  - 데이터 평면(Data Plane)에서 실행됨.
- **특징**:  
  - 로컬 작업: 각 라우터에서 독립적으로 수행.
  - 매우 짧은 시간 단위(보통 나노초 단위)로 처리.
  - **하드웨어 기반**(e.g., ASIC)을 사용하여 고속 처리.
- **예시**:  
  - 패킷의 목적지 IP 주소를 기반으로 **포워딩 테이블**을 참고해 올바른 출력 포트(출력 링크)로 전달.
  - **LAN 스위치**가 Ethernet 프레임을 목적지 MAC 주소에 따라 출력 포트로 전달.

---

### **라우팅(Routing)**

- **정의**:  
  패킷이 **출발지에서 목적지**까지 도달하는 경로를 결정하는 작업이다.  
  - 네트워크 전체의 경로 정보를 계산하여 **라우팅 테이블**을 생성 및 갱신.
  - 제어 평면(Control Plane)에서 실행됨.
- **특징**:  
  - 글로벌 작업: 네트워크 전반의 상태를 고려하여 수행.
  - 라우터 간 협력을 통해 경로 정보를 교환.
  - 시간이 오래 걸리며 **소프트웨어 기반**으로 실행.
  - **라우팅 알고리즘**(e.g., Dijkstra, Bellman-Ford)이 사용됨.
- **예시**:  
  - OSPF(Open Shortest Path First) 프로토콜이 네트워크의 전체 링크 상태 정보를 바탕으로 최적 경로를 계산.
  - BGP(Border Gateway Protocol)가 여러 네트워크 도메인 간의 경로를 설정.

---

### **차이점 요약**

| **구분**          | **포워딩(Forwarding)**                        | **라우팅(Routing)**                                |
|--------------------|---------------------------------------------|--------------------------------------------------|
| **역할**           | 입력 링크 → 출력 링크로 패킷 전달           | 출발지에서 목적지까지 데이터그램 경로 결정         |
| **범위**           | 로컬 라우터에서 수행                        | 네트워크 전반에서 수행                           |
| **실행 계층**      | 데이터 평면                                  | 제어 평면                                        |
| **속도**           | 매우 빠름(나노초 단위 처리)                 | 비교적 느림(경로 계산 시간이 필요)                |
| **기술**           | 포워딩 테이블 참조                          | 라우팅 테이블 및 라우팅 알고리즘 활용             |
| **기반 기술**      | 하드웨어                                    | 소프트웨어                                       |

---

### **비유를 통한 이해**
- **포워딩**:  
  기차역에서 도착한 열차를 확인하고, 열차가 갈 다음 플랫폼(출력 링크)을 결정하는 작업.
- **라우팅**:  
  열차가 출발지에서 목적지까지 어떤 노선(경로)을 따라가야 할지 설계하는 작업.

---

### **정리된 예시**

1. **포워딩**:  
   라우터 A가 들어온 패킷의 목적지 IP 주소를 확인하고, 출력 링크 #3으로 전달.
   - 처리 시간: **1~2 나노초.**
2. **라우팅**:  
   네트워크 내 라우터들이 OSPF를 통해 네트워크 토폴로지를 공유하고, 최단 경로를 계산.
   - 처리 시간: **몇 초~수 분.**


## **전통적인 제어 평면과 SDN 제어 평면의 차이**

---

#### **1. 전통적인 제어 평면**
- **구조**:  
  제어 평면과 데이터 평면이 **라우터 내부에 통합**되어 있음.
- **작동 방식**:  
  - 각 라우터에서 **독립적으로 라우팅 알고리즘**을 실행.
  - 라우터 간의 **라우팅 프로토콜**을 통해 라우팅 메시지를 교환하여 네트워크 전체의 경로 정보를 계산.
  - 라우터는 **포워딩 기능**과 **라우팅 알고리즘 기능**을 모두 수행.
- **특징**:  
  - 라우팅 테이블은 각 라우터가 스스로 계산.
  - 라우팅 정보 교환은 분산된 방식으로 수행.
  - 네트워크 복잡도가 증가할수록 관리가 어려워짐.
- **예시**:  
  - **OSPF(Open Shortest Path First)**: 각 라우터가 네트워크의 링크 상태를 교환하며 최단 경로를 계산.
  - **BGP(Border Gateway Protocol)**: 네트워크 간의 경로를 계산하고 정책을 적용.

---

#### **2. SDN 제어 평면**
- **구조**:  
  제어 평면과 데이터 평면이 **물리적으로 분리**되어 있음.
  - 제어 평면은 **중앙화된 원격 컨트롤러**에서 실행.
  - 데이터 평면은 **라우터나 스위치**에서 단순히 포워딩을 수행.
- **작동 방식**:  
  - **중앙 컨트롤러**가 네트워크 전반의 경로를 계산하고, 각 라우터에 **포워딩 테이블**을 분배.
  - 라우터는 컨트롤러와 메시지를 교환하여 업데이트된 정보를 받음.
  - 포워딩 테이블 계산 및 경로 설정은 컨트롤러에서 소프트웨어적으로 수행.
- **특징**:  
  - 중앙 컨트롤러로 인해 네트워크의 글로벌 뷰를 제공.
  - 라우터는 단순히 포워딩 작업만 수행(하드웨어 최적화).
  - 중앙화된 접근으로 네트워크 관리와 정책 적용이 용이.
  - 원격 컨트롤러는 고신뢰성과 중복성을 갖춘 데이터 센터에 위치.
- **예시**:  
  - **OpenFlow**: 컨트롤러가 스위치와 통신하여 포워딩 테이블을 설정.

---

### **주요 차이점**

| **구분**                | **전통적인 제어 평면**                                     | **SDN 제어 평면**                                      |
|-------------------------|--------------------------------------------------------|-----------------------------------------------------|
| **구조**                | 제어 평면과 데이터 평면이 라우터에 통합                   | 제어 평면과 데이터 평면이 물리적으로 분리             |
| **제어 방식**           | 각 라우터가 독립적으로 라우팅 알고리즘 실행                | 중앙 컨트롤러가 경로 계산 및 포워딩 테이블 분배       |
| **라우팅 정보 교환 방식**| 라우터 간 분산된 라우팅 프로토콜 사용                    | 컨트롤러와 라우터 간 메시지 교환                     |
| **복잡성**              | 네트워크 규모가 커질수록 관리 및 확장이 어려움             | 중앙화된 관리로 대규모 네트워크에서도 효율적 관리 가능|
| **포워딩 기능**          | 라우터가 포워딩 및 라우팅 모두 수행                      | 라우터는 포워딩만 수행                               |
| **예시**                | OSPF, BGP                                              | OpenFlow                                            |

---

### **비유를 통한 이해**
- **전통적인 제어 평면**:  
  각 라우터가 독립적인 운전자처럼 자신의 경로를 계획하고 운전하며, 다른 운전자와 협력해 길을 찾음.
- **SDN 제어 평면**:  
  중앙 교통 관제소(컨트롤러)가 모든 운전자에게 최적 경로를 지시하고, 운전자는 지시에 따라 움직이는 시스템.

---

### **요약**
- **전통적인 접근**: 제어 평면이 각 라우터 내부에 존재하며, 분산된 방식으로 라우팅 및 포워딩을 모두 처리.
- **SDN 접근**: 제어 평면이 중앙 컨트롤러로 이동하여, 포워딩 테이블을 계산하고 분배하며, 라우터는 단순히 포워딩을 수행. SDN은 네트워크 관리의 단순화, 유연성, 확장성을 가능하게 한다.

## 4.1.2 네트워크 서비스 모델

### 인터넷 네트워크 계층은 네트워크 계층의 한 구현 사례이다

인터넷 네트워크 계층은 네트워크 계층(Network Layer)의 한 구현 사례이다.    
두 용어는 본질적으로 동일한 계층을 의미하지만, 인터넷 네트워크 계층은 **특정한 설계와 구현 방식**을 따르기 때문에 일반적인 네트워크 계층에서 설명되는 일부 기능과는 차이가 있을 수 있다. 이를 이해하기 위해 인터넷 네트워크 계층의 위치와 특징을 살펴본다.

---

### **1. 네트워크 계층의 개념**
- **네트워크 계층**은 OSI 7계층 모델에서 **3계층**에 해당하며, 데이터를 출발지에서 목적지로 전달하는 역할을 수행한다.
- 일반적인 네트워크 계층은 다음과 같은 서비스를 제공할 수 있다:
  - **보장된 전달** (Guaranteed Delivery)
  - **지연 제한** (Delay Guarantee)
  - **순서화된 전달** (Ordered Delivery)
  - **대역폭 보장** (Bandwidth Guarantee)
  - **보안** (Encryption, Confidentiality)

---

### **2. 인터넷 네트워크 계층**
- 인터넷 네트워크 계층은 **TCP/IP 모델의 네트워크 계층**에 해당하며, 전 세계적으로 사용되는 인터넷 프로토콜(IP)을 기반으로 동작한다.
- 인터넷 네트워크 계층의 설계는 단순성과 확장성에 초점을 맞추며, 최선형 서비스(**Best-Effort Service**)를 제공한다.
- 인터넷 네트워크 계층의 핵심 역할은 다음과 같다:
  - 데이터를 **패킷(데이터그램)** 단위로 전달한다.
  - 라우터를 통해 **목적지 IP 주소**에 따라 패킷을 포워딩한다.
  - 상위 계층(트랜스포트 계층)에서 요구하는 신뢰성이나 품질 보장 없이 **최대한 빠르게 데이터를 전송한다**.

---

### **3. 인터넷 네트워크 계층과 일반 네트워크 계층의 차이**

| **구분**                 | **일반 네트워크 계층**                                    | **인터넷 네트워크 계층**                                |
|--------------------------|---------------------------------------------------------|-------------------------------------------------------|
| **서비스 수준**          | 보장된 전달, 지연 보장, 대역폭 보장 등을 지원할 수 있다.  | 최선형 서비스만 제공하며, 보장된 전달이나 지연 보장은 하지 않는다. |
| **신뢰성**               | 특정 네트워크에서 신뢰성 있는 데이터 전달을 구현할 수 있다. | 신뢰성을 제공하지 않으며, 상위 계층(TCP)에 의존한다.    |
| **구조**                 | 특정 네트워크 환경에 맞게 설계 가능하다.                  | 전 세계적으로 확장 가능한 단순한 구조를 채택한다.      |
| **패킷 처리**            | 복잡한 QoS를 포함한 패킷 처리가 가능하다.                 | 빠르고 단순한 패킷 포워딩에 초점을 맞춘다.            |
| **예시**                 | ATM 네트워크, MPLS, Frame Relay.                        | IP(IPv4, IPv6) 기반 인터넷.                          |

---

### **4. 인터넷 네트워크 계층은 네트워크 계층의 예외인가?**
**아니요, 예외가 아니다.** 인터넷 네트워크 계층은 네트워크 계층의 **특수한 구현 사례**이다.  

- **일반 네트워크 계층**은 다양한 환경에서 다양한 요구사항을 만족시키기 위해 설계될 수 있는 **추상적인 개념**이다.
- 반면, **인터넷 네트워크 계층**은 TCP/IP 프로토콜 스택에서 구현된 네트워크 계층으로, 전 세계적인 확장성과 호환성을 위해 **최선형 서비스**를 채택했다.

---

### **5. 왜 인터넷 네트워크 계층은 보장된 서비스를 제공하지 않나?**
인터넷 네트워크 계층은 확장성, 비용 효율성, 단순성을 우선시하여 설계되었다.  
- **복잡한 서비스**(지연 보장, 순서화 등)는 **상위 계층(트랜스포트 계층)**에서 처리하도록 설계되었다.
- 예를 들어, **TCP**는 인터넷 네트워크 계층이 제공하지 않는 신뢰성(재전송, 순서 보장 등)을 상위 계층에서 구현한다.

---

### **6. 결론**
- **인터넷 네트워크 계층**은 네트워크 계층의 **특수한 구현 사례**이며, 네트워크 계층 설계의 한 유형이다.
- 일반적인 네트워크 계층이 제공할 수 있는 여러 서비스(보장된 전달, 지연 보장 등) 중 일부를 생략하고, 단순성과 확장성을 위해 **최선형 서비스**를 채택했다.
- 따라서 인터넷 네트워크 계층은 네트워크 계층의 한 형태이지 예외는 아니며, 특정 요구사항(전 세계적 확장성)을 만족시키기 위한 설계 철학의 결과라고 볼 수 있다.
