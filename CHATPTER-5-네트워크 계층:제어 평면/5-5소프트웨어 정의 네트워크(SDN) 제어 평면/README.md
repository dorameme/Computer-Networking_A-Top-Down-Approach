### SDN의 주요 개념과 특징 정리

---

#### 네트워크 스위치와 포워딩 방식
- 네트워크의 포워딩 장비들은 '패킷 스위치' 또는 간단히 '스위치'라 부른다.
- 스위치의 포워딩 결정은 다양한 계층의 패킷 헤더 값을 기반으로 한다:
  - 네트워크 계층: 출발지/목적지 주소 (IP 주소)
  - 링크 계층: 출발지/목적지 주소 (MAC 주소)
  - 트랜스포트 계층 및 기타 계층: 다양한 패킷 헤더 값
- 여기서 네트워크 계층과 링크 계층 모두 출발지와 목적지 주소를 다루지만, 주소 체계와 역할이 다르다.

---

### 네트워크 계층과 링크 계층의 비교

| 특징                | 네트워크 계층 (Network Layer)        | 링크 계층 (Link Layer)             |
|--------------------------|-----------------------------------------|----------------------------------------|
| 주소 종류            | IP 주소 (논리적 주소)                  | MAC 주소 (물리적 주소)                 |
| 주소 범위            | 전 세계적, 네트워크 간                 | 로컬 네트워크 내부                     |
| 역할                | 종단 간(end-to-end) 데이터 전달         | 로컬 장치 간 데이터 전달               |
| 사용 사례            | 인터넷(라우팅)                        | LAN/WLAN(스위칭)                      |
| 변경 가능성          | 네트워크 이동 시 변경 가능              | 하드웨어에 고정                        |
| 예시                | `192.168.1.1`, `2606:4700::1111`       | `00:1A:2B:3C:4D:5E`                   |

- 네트워크 계층 (IP 주소):
  - 역할: 네트워크 간 데이터 전송을 담당하며, 종단 간(end-to-end) 통신을 위한 논리적 주소를 사용한다.
  - 사용 사례: 인터넷 같은 큰 네트워크에서 목적지까지 데이터 전달.
  - 주소 범위: 전 세계적으로 고유.
- 링크 계층 (MAC 주소):
  - 역할: 로컬 네트워크(Local Network) 내에서 데이터 전송을 담당하며, 물리적 주소를 기반으로 통신.
  - 사용 사례: 이더넷이나 Wi-Fi와 같은 로컬 네트워크 내부 데이터 전송.
  - 주소 범위: 로컬 네트워크 내에서 고유.

---

### SDN 구조의 주요 특징

1. 플로우 기반 포워딩
   - SDN 스위치의 포워딩은 트랜스포트 계층, 네트워크 계층, 링크 계층 헤더 값 등을 기반으로 이루어진다.
   - 이는 전통적인 라우터의 목적지 주소 기반 포워딩과 대조적이다.
   - 플로우 테이블의 항목 계산, 관리, 설치는 모두 SDN 제어 평면의 임무이다.

2. 데이터 평면과 제어 평면의 분리
   - 데이터 평면: 네트워크 스위치들로 구성되며, 플로우 테이블에 따라 "매치 플러스 액션"을 수행하는 단순하지만 빠른 장치들이다.
   - 제어 평면: 스위치들의 플로우 테이블을 결정, 관리하는 소프트웨어로 구성되며, 네트워크 외부의 서버에서 실행된다.

3. 제어 평면의 구성요소
   - SDN 컨트롤러 (네트워크 운영체제):
     - 네트워크 상태 정보를 유지 및 관리.
     - 제어 애플리케이션에 정보를 제공.
     - 네트워크 장치를 모니터링, 프로그래밍, 제어하는 수단 제공.
     - 단일 중앙 서버처럼 보이지만, 실제로는 협업 능력과 확장성을 위해 분산된 여러 서버에서 실행.
   - SDN 네트워크 제어 애플리케이션:
     - SDN 컨트롤러가 제공하는 API를 사용하여 네트워크를 프로그램.
     - 예: 다익스트라 알고리즘을 통해 경로를 계산하고 네트워크 장치를 제어.

---

### SDN의 프로그램 가능한 네트워크
- SDN 컨트롤러와 API를 활용하여 네트워크를 명세하고 제어 가능.
- 라우팅 애플리케이션:
  - SDN 컨트롤러의 상태 정보를 기반으로 알고리즘 수행.
  - 출발지와 목적지 간 최적 경로 결정.

---
### 기존 네트워크와 SDN 비교

| 특징                      | 기존 네트워크                            | SDN                                      |
|-------------------------------|---------------------------------------------|---------------------------------------------|
| 설정 방식                  | 하드웨어 기반의 수동 설정 (CLI 사용)         | 소프트웨어를 통한 자동화된 설정 (API 사용)   |
| 제어 방식                  | 장치별 개별 관리                             | 중앙집중형 관리 (SDN 컨트롤러)               |
| 유연성                     | 제한적 (정적 구성)                          | 동적이고 유연한 설정 가능                     |
| 설정 변경 속도             | 느리고 번거롭다                             | 실시간 변경 가능                              |
| 의존성                     | 제조사 전용 소프트웨어와 하드웨어에 의존      | 표준 API로 구성 가능                          |
| 운영 자동화                | 낮다                                        | 높다                                         |
| 확장성                     | 제한적                                      | 손쉽게 확장 가능                              |

---

### SDN의 프로그래밍 가능성 예제

1. 네트워크 경로 최적화  
   SDN 컨트롤러가 네트워크 혼잡 상태를 실시간으로 확인하고, 혼잡 구간을 우회하도록 경로를 동적으로 설정한다.  
   예: Python 스크립트를 사용하여 대규모 트래픽이 발생하는 시간대에 우선순위 경로를 설정한다.

2. 보안 정책 적용  
   의심스러운 패킷이 감지되면, SDN 컨트롤러가 실시간으로 플로우 테이블을 업데이트하여 해당 트래픽을 차단한다.  
   예: DDOS 공격이 탐지되면 공격 출발지 IP를 모든 스위치에서 차단한다.

3. QoS(서비스 품질) 관리  
   비디오 스트리밍 트래픽에 대해 대역폭을 우선 할당하도록 SDN 컨트롤러가 설정한다.  
   예: 스트리밍 서비스 IP의 트래픽을 최우선 처리하도록 스위치를 구성한다.

4. 자동 장애 복구  
   네트워크 링크 장애가 발생하면, SDN 컨트롤러가 자동으로 우회 경로를 설정한다.  
   예: 링크 장애 시 백업 경로를 즉시 활성화하여 서비스 중단을 방지한다.
### 요약
SDN은 네트워크 제어를 중앙 집중화하고, 데이터 평면과 제어 평면을 분리하여 효율적이고 유연한 네트워크 관리가 가능하다.       
플로우 기반 포워딩과 API를 통한 프로그램 가능성이 주요 특징으로, 이는 전통적인 네트워크 관리 방식과 큰 차별점을 가진다.   

---

## SDN 제어 평면: SDN 컨트롤러와 네트워크 제어 애플리케이션
![Image](https://github.com/user-attachments/assets/e35c5d68-96b4-44cc-a5e8-4bf37e9f2ece)

SDN 은 
1. SDN컨트롤러 2.네트워크 제어 애플리케이션 으로 이루어져있다.

#### SDN 컨트롤러의 기능과 구성 요소

SDN 컨트롤러는 네트워크를 효율적으로 제어하고 관리하기 위해 세 가지 주요 계층으로 구성된다.

1. 네트워크 제어 애플리케이션 계층과의 인터페이스
2. 네트워크 전역 상태 관리 계층
3. 통신 계층

---

#### 1. 통신 계층: 제어받는 장치들과의 통신

SDN 컨트롤러는 네트워크 장치의 동작을 제어하기 위해 통신 프로토콜을 사용한다. 주요 특징은 다음과 같다:

- 컨트롤러와 네트워크 장치 간의 정보 전달을 담당한다.
- 네트워크 장치는 주변에서 발생한 이벤트를 컨트롤러에 전달하여 최신 상태 정보를 제공한다.
- 이 과정은 사우스바운드(southbound) 인터페이스를 통해 이루어진다.

주요 프로토콜: OpenFlow가 대표적인 예이며, 대부분의 SDN 컨트롤러에서 이를 사용한다.

##### 비유:

통신 계층은 배달 네트워크에서 배달원이 본부와 주고받는 정보와 같다. 배달원은 고객의 요청(이벤트)을 본부에 전달하고, 본부는 이에 따라 배달 경로(플로우 테이블)를 지시한다.

---

#### 2. 네트워크 전역 상태 관리 계층

SDN 컨트롤러는 네트워크 상태를 관리하고 최신 정보를 유지한다. 주요 특징은 다음과 같다:

- 네트워크 호스트, 링크, 스위치 등의 최신 상태 정보를 관리한다.
- 각 스위치의 플로우 테이블을 저장하고, 이를 활용해 네트워크 트래픽을 제어한다.
- 플로우 테이블의 카운터 값 등 세부 정보도 관리 대상에 포함된다.

궁극적인 목표: 네트워크 전역의 상태 정보를 바탕으로 플로우 테이블을 결정하고, 효율적인 제어를 수행한다.

##### 비유:

이 계층은 교통 관제 센터와 같다. 관제 센터는 도로 상태와 교통량 정보를 실시간으로 수집하여 각 신호등의 작동을 제어한다.

---

#### 3. 네트워크 제어 애플리케이션 계층과의 인터페이스

컨트롤러는 네트워크 제어 애플리케이션과 상호작용하며, 다음과 같은 기능을 제공한다:

- 노스바운드(northbound) 인터페이스를 통해 애플리케이션과 통신한다.
- 애플리케이션이 네트워크 상태 정보와 플로우 테이블을 읽고 쓸 수 있도록 한다.

##### 비유:

이 계층은 기업의 본부와 각 부서 간의 소통 창구와 같다. 본부(컨트롤러)는 부서(애플리케이션)가 필요한 데이터를 제공하며, 부서는 이를 바탕으로 작업을 수행한다.

---

#### SDN 컨트롤러의 구조와 특징

- 논리적으로 중앙 집중된 구조: SDN 컨트롤러는 외부에서 단일 서비스처럼 보인다.
- 물리적으로 분산된 구조: 데이터베이스와 서비스는 분산된 서버 집합에 구현된다.
  - 이유: 장애 허용성(fault tolerance)과 높은 가용성을 제공하기 위해.
  - 효과: 네트워크 장치와 애플리케이션의 증가에도 확장 가능한 서비스 제공.

### SDN 구성 요소와 설명

SDN은 크게 두 가지 주요 구성 요소로 이루어진다:
1. SDN 컨트롤러
2. 네트워크 제어 애플리케이션

#### SDN 구성 요소 개요
| 구성 요소                | 세부 구성                           | 설명                                                                                     |
|---------------------------|--------------------------------------|------------------------------------------------------------------------------------------|
| 1. SDN 컨트롤러      | 네트워크 제어 애플리케이션 인터페이스 | 네트워크 제어 애플리케이션과 상호작용하는 인터페이스를 제공하며, 노스바운드 API를 통해 구현됨. |
|                           | 네트워크 전역 상태 관리 계층         | 네트워크 호스트, 스위치, 링크 등의 최신 정보를 관리하며, 플로우 테이블 상태를 유지함.       |
|                           | 통신 계층                           | SDN 컨트롤러와 네트워크 장치 간 정보를 주고받는 역할을 하며, 주로 OpenFlow 프로토콜 사용. |
| 2. 네트워크 제어 애플리케이션 | 사용자 정의 제어 로직                | 트래픽 엔지니어링, 경로 최적화, 보안 정책 등을 포함한 다양한 사용자 정의 애플리케이션 로직. |
|                           | 네트워크 상태 분석                  | 네트워크 상태 데이터를 기반으로 분석 및 의사결정을 수행함.                               |

#### SDN 컨트롤러 설명
1. 네트워크 제어 애플리케이션 인터페이스:
   - 노스바운드 인터페이스를 통해 네트워크 제어 애플리케이션과 상호작용한다.
   - 애플리케이션이 네트워크 상태 정보와 플로우 테이블을 읽고 쓸 수 있도록 지원한다.

2. 네트워크 전역 상태 관리 계층:
   - 네트워크 상태(예: 스위치, 링크, 플로우 테이블 등)를 중앙에서 관리한다.
   - GPS 네비게이션처럼 전체 네트워크의 최신 상태를 바탕으로 최적의 경로를 제안한다.

3. 통신 계층:
   - 컨트롤러와 네트워크 장치 간의 정보 교환을 담당한다.
   - OpenFlow와 같은 표준 프로토콜을 사용하여 사우스바운드 인터페이스를 통해 통신한다.

#### 네트워크 제어 애플리케이션 설명
1. 사용자 정의 제어 로직:
   - 각 네트워크 상황에 맞춘 사용자 정의 로직을 구현한다.
   - 예를 들어, 특정 서비스 품질(QoS)을 보장하기 위한 트래픽 관리 로직을 포함한다.

2. 네트워크 상태 분석:
   - 네트워크 전역 상태 데이터를 바탕으로 실시간 분석과 의사결정을 수행한다.
   - 데이터 기반 접근법으로 네트워크의 효율성과 보안을 강화한다.

#### 노스바운드 인터페이스와 사우스바운드 인터페이스의 차이
| 인터페이스 유형          | 설명                                                                                       |
|---------------------------|------------------------------------------------------------------------------------------|
| 노스바운드 인터페이스 | SDN 컨트롤러와 네트워크 제어 애플리케이션 간의 상호작용을 담당. 애플리케이션이 네트워크 상태를 읽고 조작 가능. |
| 사우스바운드 인터페이스 | SDN 컨트롤러와 네트워크 장치 간의 통신을 담당. 장치의 상태 정보를 컨트롤러에 전달하고 명령을 수신함.         |

##### 주요 차이점:
- 방향성: 노스바운드는 컨트롤러에서 애플리케이션으로, 사우스바운드는 컨트롤러에서 네트워크 장치로 통신.
- 목적: 노스바운드는 애플리케이션의 로직 구현을 지원하고, 사우스바운드는 네트워크 장치 제어와 상태 업데이트를 지원.

---

### 5.5.2 OpenFlow 프로토콜

OpenFlow 프로토콜은 SDN 컨트롤러와 네트워크 장치(스위치 등) 간의 소통을 돕는 다리 역할을 한다.
\
이 프로토콜은 TCP 상에서 동작하며, 디폴트 포트 번호는 6653이다.
이를 통해 애플리케이션은 네트워크 상태를 제어하고 관리할 수 있다.

---

#### OpenFlow 프로토콜에서 컨트롤러가 스위치로 전달하는 주요 메시지

1. 설정

   - 컨트롤러가 스위치의 설정 파라미터를 문의하거나 설정할 수 있도록 한다.

2. 상태 수정

   - 컨트롤러가 스위치의 플로우 테이블 엔트리를 추가, 제거 또는 수정하거나 스위치 포트의 특성을 설정하기 위해 사용된다.

3. 상태 읽기

   - 컨트롤러가 스위치 플로우 테이블과 포트로부터 통계 정보와 카운터값을 얻기 위해 사용된다.

4. 패킷 전송

   - 컨트롤러가 스위치의 지정된 포트에서 특정 패킷을 내보내기 위해 사용된다.
   - 이 메시지는 페이로드 부분에 보낼 패킷을 포함한다.

---

#### OpenFlow 프로토콜에서 스위치가 컨트롤러로 전달하는 주요 메시지

1. 플로우 제거

   - 어떤 플로우 테이블 엔트리가 시간이 만료되었거나 상태 수정 메시지로 인해 삭제되었음을 컨트롤러에게 알린다.

2. 포트 상태

   - 스위치가 포트의 상태 변화를 컨트롤러에게 알리기 위해 사용된다.

3. 패킷 전달

   - 스위치 포트에 도착한 패킷 중에서 플로우 테이블 엔트리와 일치하지 않는 패킷은 컨트롤러에게 전달된다.
   - 어떤 엔트리와 일치한 패킷 중에서도 일부는 추가 작업을 위해 컨트롤러로 전달된다.

---

#### OpenFlow 프로토콜의 역할

OpenFlow는 SDN의 통신 계층에서  TCP위에서 동작하며, 다음과 같은 기능을 수행한다:

- 애플리케이션과 네트워크 사이의 연결: OpenFlow는 애플리케이션이 네트워크 장치를 제어할 수 있도록 하며, 장치에서 발생하는 이벤트를 애플리케이션으로 전달한다.
- 네트워크 제어와 관리: 플로우 테이블 수정, 상태 확인, 패킷 전송 등을 가능하게 한다.

##### 비유:

OpenFlow는 스마트폰의 운영 체제와 같다.       
스마트폰 운영 체제는 앱(애플리케이션)과 하드웨어(네트워크 장치) 간의 원활한 소통과 제어를 돕는다.      
앱이 명령을 내리면, 운영 체제는 이를 하드웨어에서 실행하며, 하드웨어의 상태를 앱으로 다시 전달한다.

---
![Image](https://github.com/user-attachments/assets/ffbefc7c-59b2-42ec-be23-0c9840486f88)

주요 구성 요소

데이터 평면:

실제 패킷 전송을 담당하는 네트워크 장비들(s1, s2, s3, s4).

제어 평면:

네트워크 상태를 수집하고 경로를 계산하며, 플로우 테이블을 관리하는 계층.

링크 상태 관리자, 플로우 테이블 관리자, 다익스트라 알고리즘을 포함한다.

프로토콜:

OpenFlow를 통해 데이터 평면과 제어 평면 간의 통신이 이루어진다.

결론

이 그림은 SDN 컨트롤러가 네트워크의 중앙 집중화된 제어를 통해 데이터 평면의 효율적인 동작을 보장하는 과정을 시각적으로 잘 보여준다.      
다익스트라 알고리즘을 통해 네트워크의 링크 상태 변화에 신속히 대응할 수 있으며, 플로우 테이블 갱신을 통해 트래픽 흐름을 최적화한다.

----

## 5.5.4 SDN: 과거와 미래

### 5.5.4 SDN: 과거와 미래

과거  
SDN의 기원은 데이터와 제어 평면 분리로 거슬러 올라간다.  
2004년, 연구[RFC 3746 등]에서 데이터와 제어 평면 분리를 주장했으며, 2007년 에탄(Ethane) 프로젝트[Casado 2007]는 다음 개념을 제안했다:  
1. ‘매치 플러스 액션’ 플로우 테이블을 사용하는 이더넷 스위치.  
2. 플로우 관리용 중앙 집중식 컨트롤러.  
3. 미매칭 패킷을 컨트롤러로 전달.  

에탄 프로젝트는 OpenFlow로 발전했으며, 2007년 300개 이상의 스위치 네트워크를 운영했다.

미래  
SDN은 상용 스위치 하드웨어와 정교한 소프트웨어 제어로 기존 통합형 장비를 대체하고 있다.         
여기서 기존 통합형 장비는 주로 미들박스(middlebox)를 의미하며, 방화벽, 로드밸런서, NAT, 미디어 캐싱 장비 등 특정 네트워크 기능을 수행하기 위해 설계된 전용 하드웨어와 소프트웨어로 구성된 장비이다.  

SDN과 NFV는 이러한 미들박스를 일반 상용 서버, 스위치, 저장소 등으로 대체함으로써 유연성과 비용 효율성을 높이고 있다.  
또한, SDN의 일반화된 형태인 네트워크 기능 가상화(NFV)는 복잡한 네트워크 장비를 혁신적으로 대체하는 것을 목표로 한다.  

현재 연구는 SDN 개념을 AS 내부 설정에서 AS 간 설정으로 확장하여 적용하는 방향으로도 발전 중이다.  

미들박스를 SDN으로 교체해야 하는 이유는 다음과 같은 이점 때문이다:
### 미들박스 vs SDN 비교표

| 구분         | 미들박스 (Middlebox)                                      | SDN (Software-Defined Networking)                                  |
|-------------------|-------------------------------------------------------------|------------------------------------------------------------------------|
| 구조         | 하드웨어와 소프트웨어가 통합된 전용 장비                      | 데이터 평면과 제어 평면이 분리된 구조                                  |
| 유연성       | 기능 확장이 제한적이며, 전용 하드웨어에 의존                  | 소프트웨어 기반으로 기능 확장이 유연                                   |
| 관리         | 개별 장비마다 별도의 관리 필요                                | 중앙 집중식 컨트롤러로 네트워크 전체를 관리                            |
| 비용         | 고비용의 전용 하드웨어 필요                                   | 상용 하드웨어와 소프트웨어로 비용 절감 가능                            |
| 확장성       | 장비 추가 및 확장이 어려움                                    | 네트워크 규모 확장이 용이                                              |
| 사용 사례    | 방화벽, NAT, 로드밸런서, 미디어 캐싱                         | 데이터 센터 네트워크, 클라우드, 네트워크 자동화                        |
| 효율성       | 전용 기능 수행에 최적화되었지만 특정 워크로드에 한정적        | 다양한 네트워크 기능을 소프트웨어로 처리 가능                          |
| 제어 방식    | 분산 제어 방식 (각 장비 개별 제어)                            | 중앙 집중식 제어 (컨트롤러 기반)                                       |
| 유지보수     | 하드웨어 장애 시 복잡한 교체 작업 필요                        | 소프트웨어 업데이트로 문제 해결 가능                                   |
| 기술 목표    | 특정 네트워크 기능의 고성능 제공                              | 네트워크 전체의 가시성, 유연성, 자동화를 통한 최적화                   |
| 예시 기술    | 방화벽, 로드밸런서, WAN 최적화 장비                          | OpenFlow, NFV, BGP-SDN                                                |

요약:  
미들박스는 특정 네트워크 기능을 고성능으로 제공하기 위해 설계된 전용 장비지만 유연성과 확장성이 부족하다.    
 반면, SDN은 데이터 평면과 제어 평면 분리를 통해 소프트웨어로 제어 가능하며, 네트워크 관리와 확장성에서 뛰어난 유연성을 제공한다.

----

 ## SDN 컨트롤러 사례: OpenDaylight와 ONOS

1. OpenDaylight 컨트롤러  
- 비유: 레고 블록처럼 다양한 부품을 조립해서 원하는 네트워크를 만들 수 있는 컨트롤러.  
- 특징:  
  - 여러 네트워크 프로토콜(OpenFlow, NETCONF 등)을 지원.  
  - 확장성과 유연성이 뛰어나서 다양한 환경(특히 클라우드)에 적합.  
  - 플러그인으로 기능을 쉽게 추가 가능.  
- 사용 사례: 대규모 데이터 센터와 클라우드 네트워크 관리.  
- 예시: 클라우드 서비스 제공자가 복잡한 네트워크를 효율적으로 관리하려고 OpenDaylight를 사용.

2. ONOS (Open Network Operating System) 컨트롤러  
- 비유: 스마트 교통 관제 시스템처럼 대규모 네트워크를 안정적으로 운영하는 컨트롤러.  
- 특징:  
  - 분산형 구조로 고속 도로(대규모 네트워크)에서도 원활하게 작동.  
  - 장애가 발생해도 복구가 빠르고, 안정적으로 서비스 제공.  
  - 대규모 ISP나 광대역 네트워크에 적합.  
- 사용 사례: 인터넷 서비스 제공업체(ISP)에서 안정적으로 데이터 흐름을 관리할 때 사용.  
- 예시: 여러 도시를 연결하는 네트워크에서 장애 없이 데이터를 안정적으로 전달하려고 ONOS를 사용.

---

### OpenDaylight와 ONOS 비교표 (쉽게 정리)

| 항목          | OpenDaylight                                   | ONOS                                      |
|-------------------|---------------------------------------------------|----------------------------------------------|
| 비유          | 레고 블록: 원하는 기능을 조립해서 사용.             | 스마트 교통 관제 시스템: 대규모 네트워크 안정 관리. |
| 구조          | 모듈형(유연하고 확장 가능).                         | 분산형(확장성과 안정성에 초점).               |
| 장점          | 다양한 기능 추가 가능, 클라우드 환경에 적합.         | 장애 복구와 안정성 강점, 대규모 네트워크에 적합. |
| 단점          | 대규모 확장 시 한계.                                | 플러그인 및 프로토콜 지원이 제한적.           |
| 사용 사례     | 클라우드 데이터 센터 관리.                          | ISP나 광대역 네트워크 관리.                   | 

요약 비유  
- OpenDaylight: 필요한 기능을 쌓아 올려 만드는 맞춤형 네트워크 도구.  
- ONOS: 대규모 네트워크를 안정적으로 제어하는 신뢰성 높은 시스템.  
