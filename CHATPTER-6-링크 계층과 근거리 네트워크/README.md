
### 6.6 데이터 센터 네트워킹

데이터 센터는 내부 호스트들 간의 상호 연결을 위해 데이터 센터 네트워크(data center network)를 갖추고 있으며, 외부 인터넷과 연결되어 있다.

데이터 센터는 다음과 같은 3가지 주요 목적을 가진다:

1. 콘텐츠 제공: 웹 페이지, 검색 결과, 전자메일, 스트리밍 비디오 등 콘텐츠를 제공한다.
2. 병렬 컴퓨팅 인프라: 검색 엔진의 분산 인덱스 계산과 같은 대량 데이터 처리 작업을 지원한다.
3. 클라우드 컴퓨팅 제공: 다른 회사들에게 클라우드 컴퓨팅 서비스를 제공한다.

---

### 6.6.1 데이터 센터 구조

#### 데이터 센터 구성 요소

![Image](https://github.com/user-attachments/assets/4a0f966b-c261-4a0b-a92d-8b9c2d84d410)

### 호스트
1. 역할: 데이터 센터에서 실제 작업을 수행하는 범용 서버이다.
2. 특징:
   - 흔히 "피자 박스 모양"의 블레이드(blade)라고 부른다.
   - CPU, 메모리, 디스크 저장장치 같은 기본 하드웨어를 포함한다.
   - 한 랙(rack)에 20~40대의 블레이드가 적재될 수 있다.
   - 데이터 센터 내부에서만 사용되는 고유 IP 주소를 할당받는다.
   - 비유하자면, 호스트는 각각의 일꾼이며, 랙은 이들 일꾼들이 모여 일하는 작업장이라 할 수 있다.

### 랙(Rack)
  - 랙은 데이터 센터에서 블레이드 서버를 물리적으로 수납하는 금속 프레임 구조물이다. 
  - 이는 책장을 연상하면 된다. 각각의 칸에 블레이드를 넣어 공간을 효율적으로 사용하며,      
랙 자체는 전원 공급 장치와 네트워크 연결 포트를 포함하여 블레이드 서버들이 원활히 작동할 수 있도록 한다.

### TOR (Top of Rack) 스위치
1. 위치: 랙의 맨 위에 위치한 네트워크 장비이다.
2. 역할:
   - 랙 내부의 호스트들을 연결하는 네트워크 허브 역할을 한다.
   - 외부와 연결하기 위해 데이터 센터의 다른 스위치들과 연결된다.

---

### 경계 라우터 (Border Router)
1. 역할:
   - 데이터 센터 내부와 외부(인터넷) 간의 트래픽을 관리한다.
   - 외부 클라이언트와 내부 호스트 간의 데이터 전송을 중계한다.
2. 기능:
   - 데이터 센터 네트워크를 공용 인터넷과 연결한다.

---

### 로드 밸런싱
1. 외부 요청 처리 과정:
   - 외부 클라이언트가 애플리케이션에 접근하려면 공용 IP 주소로 요청을 보낸다.
   - 이 요청은 로드 밸런서로 전달된다.
2. 역할:
   - 여러 로드 밸런서가 특정 애플리케이션의 요청을 처리한다.
   - 요청을 적절한 호스트에 분배한다.
   - 호스트의 부하 상태를 분석해 균등하게 분배한다.
3. 기능:
   - NAT(Network Address Translation)처럼 내부 IP와 공용 IP를 변환한다.
   - 내부 구조를 숨기고 클라이언트가 직접 내부 호스트와 통신하지 못하게 해 보안을 강화한다.
4. 추가 특징:
   - 목적지 IP 주소와 포트를 기준으로 동작하기 때문에 4계층 스위치라고도 한다.

---

요약하면, 데이터 센터는 여러 호스트(서버)들이 모여 작업을 처리하며, TOR 스위치와 경계 라우터가 이를 네트워크로 연결하고, 로드 밸런서가 외부 요청을 효율적으로 분배하며 보안을 제공한다.

--- 

#### 계층적 구조

데이터 센터 네트워크는 계층 구조로 설계되며, 아래와 같은 단계로 구성된다:

1. 최상단: 경계 라우터가 접속 라우터에 연결된다.
2. 중간 단계: 접속 라우터는 최상단 스위치 및 로드 밸런서에 연결된다.
3. 하단 단계: 최상단 스위치는 2단 스위치, 그리고 2단 스위치는 TOR 스위치를 통해 여러 랙으로 연결된다.
4. 호스트 서브넷: 호스트는 랙 내에서 하나의 서브넷을 형성하며, ARP 브로드캐스트를 제한하기 위해 VLAN으로 세분화된다.

#### 문제점 및 해결 방안

- 문제점: 특정 링크가 과부하될 경우 전송 속도가 감소하며, 이는 네트워크 성능 저하로 이어진다.
- 해결 방안:
  - 고속 스위치와 라우터 사용 (비용 증가 문제 있음).
  - 관련 데이터와 서비스를 같은 위치에 배치하여 통신 최소화.
  - TOR와 2단 스위치 간, 2단과 1단 스위치 간 연결성을 증가시켜 신뢰성과 용량을 증대.

---

### 6.6.2 데이터 센터 네트워킹 동향

#### 1. 비용 감소
- 핵심 아이디어: 큰 스위치 대신 소규모 스위치를 계층적으로 연결하여 비용 절감을 실현한다.  
- 비유: 대형 트럭 한 대로 물건을 운송하기보다 작은 택배차 여러 대를 효율적으로 배치해 사용하는 것과 같다.

---

#### 2. 중앙 집중형 SDN 제어 및 관리
- SDN 역할:
  - 데이터 평면(실제 데이터 전송)과 제어 평면(데이터 흐름 관리)을 분리한다.
  - 중앙에서 모든 네트워크를 논리적으로 제어하여 효율적인 관리를 가능하게 한다.  
- 비유: 도시 전체의 교통 신호를 중앙 관제 센터에서 통합 관리하는 것과 같다.

---

#### 3. 가상화
- 기술 핵심:
  - 물리적 서버를 가상 머신(VM)으로 나눠서 애플리케이션을 유연하게 배치하고 실행한다.
  - VM의 위치에 관계없이 네트워크 연결이 유지되도록 한다.
- 비유: 집에 있는 가구를 원하는 방으로 옮길 수 있는 것처럼, VM도 자유롭게 이동할 수 있다.

---

#### 4. 물리적 제약사항 해결
- 문제: 데이터 센터는 고속 처리와 초저지연을 요구한다.
- 해결책:
  - RDMA: 데이터를 CPU를 거치지 않고 바로 전송해 속도를 높인다.
  - TCP 변형: 네트워크 혼잡을 더 빠르게 해결하는 새로운 프로토콜 적용.
- 비유: 교통 체증을 줄이기 위해 자동차가 고속도로에서 바로 목적지로 이동하도록 하는 전용 도로를 만드는 것과 비슷하다.

---

#### 5. 하드웨어 모듈화와 커스터마이징
- 핵심 아이디어:
  - 모듈화된 데이터 센터(MDC)는 선박 컨테이너 안에 소규모 데이터 센터를 구성한다.
  - 성능이 저하된 컨테이너는 교체하거나 새로 추가한다.
- 비유: 레고 블록처럼 필요에 따라 조립하거나 교체할 수 있는 시스템이다.

---

#### 6. 신뢰성 확보
- 방법:
  - 데이터 센터를 복제하고 여러 가용 구역(zone)을 만들어 신뢰성을 높인다.
  - 장애가 발생해도 서비스가 지속되도록 설계한다.
- 비유: 중요한 데이터를 다른 도시에도 백업하는 것처럼, 데이터 센터도 여러 지역에 복제본을 둔다.

---

### 쉽게 요약
1. 비용 감소: 작은 장비들을 계층적으로 연결해 효율적인 구조를 만든다.
2. 중앙 관리(SDN): 모든 네트워크를 한 곳에서 관리한다.   -> SDN으로 중앙에서 효율적 관리
3. 가상화: 서버를 자유롭게 이동하고 유연하게 운영한다.   -> 가상화로 물리계층의 자원을 좀더 효율적으로 사용
4. 속도 개선: 혼잡 문제를 줄이고, 데이터를 빠르게 처리한다.  -> TCP변형 혹은 RDMA로 CPU 과정생략
5. 모듈화: 필요할 때 컨테이너처럼 데이터 센터를 추가하거나 교체한다.    -> MDC 모듈화된 데이터서버
6. 신뢰성: 여러 지역에 데이터 복제본을 만들어 안전하게 유지한다.   -> 데이터센터를 분산시킨다.

---

데이터 센터는 마치 잘 조직된 도시처럼 작동하며, 효율성과 안전성을 동시에 추구하는 구조이다.
---

### 데이터 센터와 일반 서버의 차이점

- 규모와 인프라: 일반 서버는 단일 서버 또는 소규모 서버군으로 구성되지만, 데이터 센터는 수천 대에서 수십만 대의 서버와 복잡한 네트워크를 포함하는 대규모 시설이다.

- 서비스 제공 범위: 일반 서버는 특정 애플리케이션이나 서비스를 위한 단일 목적을 가지는 반면, 데이터 센터는 클라우드 컴퓨팅, 병렬 처리, 대규모 데이터 저장 등 다양한 서비스를 제공한다.

- 구조와 연결성: 일반 서버는 간단한 네트워크 구성을 가지며 독립적으로 작동하는 경우가 많지만, 데이터 센터는 계층적 구조와 고속 스위치를 통해 대규모 연결성을 유지한다.

- 운영 주체: 일반 서버는 개인이나 소규모 기업이 운영하는 경우가 많지만, 데이터 센터는 대규모 클라우드 제공 업체나 글로벌 기업이 소유하고 운영한다.

- 확장성: 데이터 센터는 가상화와 모듈화를 통해 유연한 확장이 가능하지만, 일반 서버는 물리적 제약이 크다.

비유하자면, 일반 서버는 "소규모 가게"이고, 데이터 센터는 "대형 쇼핑몰"과 같다.&#x20;

데이터 센터는 다양한 서비스를 제공하며, 규모와 연결성 측면에서 훨씬 더 크고 복잡하다.

